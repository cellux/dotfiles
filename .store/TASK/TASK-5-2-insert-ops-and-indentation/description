Implement tree_sitter_insert_after_node and tree_sitter_insert_before_node using the resolver to compute insertion offsets (start or end of node). Perform the buffer splice atomically, reparse to ensure the file remains syntactically valid, and optionally indent the inserted region unless skip_format is true. Fail fast on missing file, missing/ambiguous node, or parse errors; do not partially write files.